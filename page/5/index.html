
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>blog.joshmcarthur.com</title>
  <meta name="author" content="@sudojosh">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="canonical" href="http://joshmcarthur.com/blog/page/5/index.html"/>
  <link href="/favicon.ico" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="http://s3.amazonaws.com/ender-js/jeesh.min.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="blog.joshmcarthur.com" type="application/atom+xml"/>
  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>

</head>


<body  >
  <div id="container">
      <header><hgroup>
  <h1><a href="/">blog.joshmcarthur.com</a></h1>
  
</hgroup>



</header>

      <div id="main" role="main">
        <div id="content">
          <div class="blog-index">



  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2011/04/12/using-setinterval-to-handle-scroll-events/">Using setInterval to Handle Scroll() Events</a></h1>
    
    
      <p class="meta">





  



<time datetime="2011-04-12T00:00:00+12:00" pubdate  data-updated="true" >Apr 12<span>th</span>, 2011</time></p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve just added a nice unobtrusive scroll to top feature to my blog, and learnt
an interesting tip in the process I thought I would share, originating from one
of the many problems Twitter has had with it&#8217;s jQuery fanciness.
The scroll to top stuff isn&#8217;t overly complicated - just detect when the user
has scrolled x pixels down the screen, and then show a link to go back to the
top (Which can be animated if you want) - for a nice tutorial on this, check
out_this_tutorial.
The thing is that this technique uses the scroll event (bound to window, but
can be bound to basically anything with a scrollbar). The scroll event gets
fired any time the window is scrolled - but any time the scroll amount changes
at all. What this means is that the scroll event is fired any time scroll
position changes - so if you grab the scrollbar, and pull, the scroll event is
fired every time the bar moves, not when you release the mouse.
John_Resig_reports_that_Twitter_ran_into_some_problems_with_thisÂ - they had a
function bound directly to the scroll event being fired every time anyone
scrolled (at all!). Resig has also reported a nice solution though, which I&#8217;ll
pass on here. It&#8217;s actually quite simple. Instead of binding a complicated
function to the scroll event, you simply set a flag variable to let something
else know that the window has been scrolled. The second piece of the solution
is a function running via setInterval - that is, a function being called on a
scheduled basis. The first task of this function is to check this flag - if it
is set, it can perform any task (Such as showing a &#8216;Back to Top&#8217; link, and set
the flag variable back to false.Â 
The end result of this solution is that you basically have a polling function,
rather than an event-driven one. This is actually a good thing though, when it
comes to this type of event. Instead of having a complex function called every
time the window is scrolled, a function is called every quarter second or so,
and only executes if the window has been scrolledÂ - much better!
I personally used an object variable, rather than just a flag - this object was
populated with the object that was scrolled on, and I then checked if this
object was populated in my polling function (rather than just is true), and
could then use the context it provided in this function. Since then, however, I
have realized that in my case, this object will alwaysbe the window object - so
I may as well have a cheaper variable assignment and just directly refer to the
object in my polling function.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2011/04/12/i-just-found-this-it-s-a-little-promotional-thing-that-the/">I Just Found This - It&#8217;s a Little Promotional Thing That The&#8230;</a></h1>
    
    
      <p class="meta">





  



<time datetime="2011-04-12T00:00:00+12:00" pubdate  data-updated="true" >Apr 12<span>th</span>, 2011</time></p>
    
  </header>


  <div class="entry-content"><p>[/images/assets/www.tumblr.com/photo/1280/4533787560/1/
tumblr_ljiap6hYwQ1qd78lu.jpg]
I just found this - it&#8217;s a little promotional thing that the (now non-existent)
VUW (Victoria University of Wellington IT Society) did (Well, me and Eddy) to
try and get people to join up (It worked.) - basically, I built a little IR
pen, and using a Wiimote, we managed to make a nice little giant touchscreen.
Granted, it needed calibrating often, and the correct body posture and hand
position took some finding, but it was definately a fun experiment to try out.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2011/04/12/accessing-controller-instance-variables-in-model-urgh/">Accessing Controller Instance Variables in Model (Urgh?)</a></h1>
    
    
      <p class="meta">





  



<time datetime="2011-04-12T00:00:00+12:00" pubdate  data-updated="true" >Apr 12<span>th</span>, 2011</time></p>
    
  </header>


  <div class="entry-content"><p>I can tell that this title alone will irritate a lot of developers out there.
It irritated me as well, until I figured out that sometimes, doing things the
&#8216;wrong&#8217; way is the best/only way. But let me get on with things.
Every now and then, you will come across a scenario where you need to access
something in the controller, from the model. This is so obviously non-MVC that
many will (should) immediately shy away from it, but let me suggest a scenario.
Let&#8217;s say you have users, who should be scoped to a particular subdomain. You
would place a default_scope on the User model (with a Proc, once an issue with
default_scope is resolved), that would automatically add conditions to any
database lookup calls to restrict the found users to those belonging to the
current subdomain. The tricky bit is, of course to get this subdomain. Because
it is a default scope, you don&#8217;t actually &#8216;call&#8217; it - so that rules out passing
parameters. I&#8217;ve come across other suggestions as well, such as using
cattr_accessor (NO! It&#8217;s shared across requests), and storing a value in
Thread.current (Relying on the application using threads in the way you expect
them to = not safe). So far though, the best hint I have seen here, although
extremely anti-doing what I am suggesting, would seem to work.Â 
Basically, the jist of this post was that you could dynamically add methods to
ActiveRecord::Base using an around_filter to access sessions, cookies, params
and the request. Now, I agree that this might be a bit too extreme - if you
really need to access the entire session or cookie hash, for example, you
probably aredoing something wrong. Something that I think isÂ suitable though,
given an appropriate situation, is to use this technique to add an &#8216;accessor&#8217;
to ActiveRecord::Base that returns the value you need in your model - the
current subdomain for instance. This is still non-MVC, but is, I think, a far
more elegant solution that anything else I&#8217;ve seen suggested.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2011/04/08/i18n-always-escapes-dots-in-chained-backends/">I18n ALWAYS Escapes Dots in Chained Backends :-(</a></h1>
    
    
      <p class="meta">





  



<time datetime="2011-04-08T00:00:00+12:00" pubdate  data-updated="true" >Apr 8<span>th</span>, 2011</time></p>
    
  </header>


  <div class="entry-content"><p>Just a quick tip I&#8217;ve come across while browsing through the comments on a
Railscast_I&#8217;ve_been_watching. It looks like the I18n gems that get
automatically installed with Rails 3 have a teensy bug.
When storing a translation to the backend (be it YAML, Redis, whatever), there
is an :escape option that can be passed to enable (or prevent) the key from
containing the dot character (.) (Among others, I&#8217;m sure). This seems to work
fine when dealing with a single backend, but unfortunately when you are using
chained backends (For example I am using Redis preferentially, but falling back
on YAML when necessary), the options hash that you would pass the :escape
option in is mistakenly initialized to an empty hash.
It&#8217;s a simple fix - there is already a closed pull request on the issue here.
It looks like the latest stable version is only 0.50 though, so the fix isn&#8217;t
going to filter through to the actual gem just yet. For now, the best option is
probably to class_eval into that particular section, or just change the file
yourself.</p>
</div>
  
  


  </article>

<nav role="pagination">
  <div>
    
      <a class="prev" href="/page/6/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/page/4/">Newer &rarr;</a>
    
  </div>
</nav>

<script type="text/javascript">
    var disqus_shortname = 'blog-joshmcarthur';
    (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

</div>
<aside role=sidebar>
  
    <section>
  <h1>Search</h1>
  <form action="http://google.com/search" method="get" class="search">
    <fieldset role="site-search">
      <input type="hidden" name="q" value="site:joshmcarthur.com/blog" />
      <input class="search" type="text" name="q" results="0" placeholder="Search"/>
    </fieldset>
  </form>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2011/09/30/overriding-action-caches/">Overriding Action Caches</a>
      </li>
    
      <li class="post">
        <a href="/2011/09/23/howto-database-backup-and-restore/">Howto: Database Backup and Restore</a>
      </li>
    
      <li class="post">
        <a href="/2011/09/14/introducing-blog-broadcaster/">Introducing Blog Broadcaster</a>
      </li>
    
      <li class="post">
        <a href="/2011/09/09/select-anything-from-everything/">Select Anything From Everything with Select</a>
      </li>
    
      <li class="post">
        <a href="/2011/08/22/capistrano-rvm-shell-command-not-found-error/">Capistrano rvm-shell: command not found error</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/joshmcarthur">@joshmcarthur</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'joshmcarthur',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("sudojosh", 5, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/sudojosh" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @sudojosh</a>
  
</section>




  
</aside>

        </div>
      </div>
      <footer><p>
  Copyright &copy; 2011 - @sudojosh -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  </div>
  

  
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>


  
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


</body>
</html>

